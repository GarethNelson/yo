#!/usr/bin/env python3.6

import yo
import sys
import argparse

from yo.app import YoApp
from yo.config import YoConfigManager
from yo.db import init_db
from yo.blockchain_follower import YoBlockchainFollower

def main():
    parser = argparse.ArgumentParser(description="Notification service for the steem blockchain")
    parser.add_argument('-c','--config',type=str,default='./yo.cfg',help='Path to the configuration file')
    args = parser.parse_args(sys.argv[1:])

    yo_config   = YoConfigManager(args.config)
    yo_database = init_db(yo_config)
    yo_app      = YoApp(config=yo_config, db=yo_database)
    if 'blockchain_follower' in yo_config.enabled_services:
       follower = YoBlockchainFollower(config=yo_config,db=yo_database)
       yo_app.add_service(follower)
    yo_app.run()

if __name__=='__main__':
   main()
